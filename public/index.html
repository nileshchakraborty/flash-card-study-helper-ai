<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>MindFlip AI</title>
    <link href="/manifest.json" rel="manifest" />
    <meta content="#6b7280" name="theme-color" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Canvas Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />

    <link href="style.css" rel="stylesheet" />
</head>

<body class="bg-gray-50 font-sans antialiased">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                <div class="flex-1">
                    <p class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1">AI-Powered Study Helper
                    </p>
                    <h1 class="text-2xl font-bold text-primary">MindFlip AI</h1>
                    <p class="text-gray-600 max-w-2xl">
                        Create flashcards from topics, upload PDFs/images, and master your studies with AI-powered
                        learning.
                    </p>
                </div>
                <div class="flex flex-wrap gap-3">
                    <div class="bg-gray-100 px-4 py-2 rounded-lg border border-gray-200">
                        <span class="text-xs text-gray-500 block">Review</span>
                        <span class="text-lg font-semibold text-gray-700" id="left-count">0</span>
                    </div>
                    <div class="bg-gray-100 px-4 py-2 rounded-lg border border-gray-200">
                        <span class="text-xs text-gray-500 block">Mastered</span>
                        <span class="text-lg font-semibold text-gray-700" id="right-count">0</span>
                    </div>
                    <div class="bg-gray-100 px-4 py-2 rounded-lg border border-gray-200">
                        <span class="text-xs text-gray-500 block">Remaining</span>
                        <span class="text-lg font-semibold text-gray-700" id="cards-remaining">0</span>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <a href="/api/auth/google"
                        class="bg-white text-gray-700 hover:bg-gray-50 font-medium py-2 px-4 rounded-lg border border-gray-300 transition-colors flex items-center gap-2 shadow-sm">
                        <img src="https://www.svgrepo.com/show/475656/google-color.svg" class="w-5 h-5" alt="Google">
                        Login
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="bg-white border-b border-gray-200 sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex space-x-1">
                <button class="tab-btn px-6 py-4 text-sm font-medium border-b-2 transition-colors" data-tab="study">
                    <span class="material-icons align-middle mr-2">school</span>
                    Study
                </button>
                <button class="tab-btn px-6 py-4 text-sm font-medium border-b-2 transition-colors" data-tab="create">
                    <span class="material-icons align-middle mr-2">add_circle</span>
                    Create Cards
                </button>
                <a href="/quiz.html"
                    class="tab-btn px-6 py-4 text-sm font-medium border-b-2 transition-colors text-center">
                    <span class="material-icons align-middle mr-2">quiz</span>
                    Quiz
                </a>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Study Tab -->
        <section class="tab-content" id="study-tab">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Card Stack -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <div class="card-stack relative min-h-[500px] mb-6" id="card-stack"></div>
                        <div class="flex gap-4 mb-4">
                            <button
                                class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-6 rounded-lg border border-gray-300 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
                                id="revise-btn" type="button">
                                <span class="material-icons">arrow_back</span>
                                Revise
                            </button>
                            <a href="/quiz.html"
                                class="flex-1 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 font-medium py-3 px-6 rounded-lg border border-indigo-200 transition-colors flex items-center justify-center gap-2">
                                <span class="material-icons">quiz</span>
                                Take Quiz
                            </a>
                            <button
                                class="flex-1 bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
                                id="next-btn" type="button">
                                Next
                                <span class="material-icons">arrow_forward</span>
                            </button>
                        </div>
                        <p class="text-sm text-gray-500 text-center">Swipe on mobile. On desktop, click Revise (left) or
                            Next
                            (right).</p>
                    </div>
                </div>

                <!-- Study Plan -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 sticky top-24">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-semibold text-gray-900">Revision Plan</h2>
                            <button class="text-sm text-gray-600 hover:text-gray-900 font-medium" id="rebuild-plan"
                                type="button">
                                <span class="material-icons text-base align-middle">refresh</span>
                            </button>
                        </div>
                        <div class="plan-output text-sm text-gray-600" id="plan-output">
                            Swipe cards to generate a study plan.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Create Cards Tab -->
        <section class="tab-content hidden" id="create-tab">
            <div class="max-w-4xl mx-auto space-y-6">
                <!-- Generate from Topic -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-2">Generate from Topic</h2>
                    <p class="text-gray-600 mb-6">Enter a topic and let AI generate flashcards for you.</p>
                    <form class="space-y-4" id="topic-form">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="topic-input">Topic</label>
                            <input
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent outline-none transition-all"
                                id="topic-input" placeholder="e.g., Neural Networks, World War II, Calculus" required
                                type="text" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="card-count">Number of
                                Cards</label>
                            <input
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent outline-none transition-all"
                                id="card-count" max="50" min="1" placeholder="Number of cards" type="number"
                                value="10" />
                        </div>
                        <div class="flex items-center gap-2 pt-2">
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="use-browser-llm" class="sr-only peer">
                                <div
                                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary">
                                </div>
                                <span class="ml-3 text-sm font-medium text-gray-700">Use Browser AI (Offline)</span>
                            </label>
                        </div>
                        <div class="flex justify-center pt-2">
                            <button
                                class="bg-primary text-white px-8 py-3 rounded-lg hover:bg-primary-dark transition-all transform hover:scale-105 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 shadow-lg"
                                disabled id="generate-btn" type="submit">
                                <span class="material-icons">auto_awesome</span>
                                Generate Flashcards
                            </button>
                        </div>
                    </form>

                    <!-- Recent Decks History -->
                    <div class="mt-8">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                            <span class="material-icons text-primary">history</span>
                            Recent Decks
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="deck-history-list">
                            <!-- History items will be injected here -->
                            <div class="text-gray-500 text-sm italic">No recent decks found.</div>
                        </div>
                    </div>
                    <div class="status-message mt-4" id="topic-status"></div>

                    <!-- Recommended Learning Paths -->
                    <div id="recommended-paths" class="hidden mt-8 pt-8 border-t border-gray-100">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                            <span class="material-icons text-indigo-500">alt_route</span>
                            Recommended Learning Paths
                        </h3>
                        <p class="text-sm text-gray-600 mb-4">Continue your deep dive with these related topics:</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3" id="recommended-list">
                            <!-- Recommended items injected here -->
                        </div>
                    </div>
                </div>

                <!-- Upload Files -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-2">Upload Files</h2>
                    <p class="text-gray-600 mb-6">Upload PDFs or images to convert them into flashcards.</p>
                    <form class="space-y-4" id="upload-form">
                        <div class="file-upload-area border-2 border-dashed border-gray-300 rounded-lg p-12 text-center cursor-pointer hover:border-gray-400 hover:bg-gray-50 transition-colors"
                            id="upload-area">
                            <input accept=".pdf,.png,.jpg,.jpeg,.gif" class="hidden" id="file-input" multiple
                                type="file" />
                            <label class="cursor-pointer" for="file-input">
                                <span class="material-icons text-5xl text-gray-400 mb-4 block">cloud_upload</span>
                                <span class="block text-gray-700 font-medium mb-2" id="upload-text">Click to upload or
                                    drag and
                                    drop</span>
                                <span class="text-sm text-gray-500">PDF, PNG, JPG, GIF (Max 10MB)</span>
                            </label>
                        </div>
                        <div class="selected-files hidden" id="selected-files">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-sm font-medium text-gray-700">Selected Files:</span>
                                <button
                                    class="text-sm text-gray-600 hover:text-gray-900 font-medium flex items-center gap-1"
                                    id="add-more-files" type="button">
                                    <span class="material-icons text-base">add</span>
                                    Add More
                                </button>
                            </div>
                            <ul class="file-list space-y-2" id="file-list"></ul>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="upload-topic">Topic
                                (Optional)</label>
                            <input
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent outline-none transition-all"
                                id="upload-topic" placeholder="Topic for these cards (optional)" type="text"
                                value="General" />
                        </div>
                        <div class="flex justify-center pt-2">
                            <button
                                class="bg-primary text-white px-8 py-3 rounded-lg hover:bg-primary-dark transition-all transform hover:scale-105 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 shadow-lg"
                                disabled type="submit">
                                <span class="material-icons">upload_file</span>
                                Upload & Convert
                            </button>
                        </div>
                    </form>
                    <div class="status-message mt-4" id="upload-status"></div>
                    <div class="hidden mt-4" id="upload-progress">
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="progress-fill bg-gray-600 h-2 rounded-full transition-all duration-300"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quiz Tab -->
        <section class="tab-content hidden" id="quiz-tab">
            <div class="max-w-4xl mx-auto">
                <!-- Quiz Setup -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6" id="quiz-setup">
                    <h2 class="text-xl font-semibold text-gray-900 mb-6">Start a Quiz</h2>

                    <!-- Pick A Quiz Section -->
                    <div class="mb-8">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Pick A Quiz</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <button
                                class="p-4 border border-gray-200 rounded-lg hover:border-gray-400 hover:bg-gray-50 transition-all text-left group"
                                id="quiz-from-cards">
                                <span class="material-icons text-gray-400 group-hover:text-gray-900 mb-2">style</span>
                                <div class="font-medium text-gray-900">From Flashcards</div>
                                <div class="text-sm text-gray-500">Test yourself on your current deck</div>
                            </button>
                            <button
                                class="p-4 border border-gray-200 rounded-lg hover:border-gray-400 hover:bg-gray-50 transition-all text-left group"
                                id="quiz-from-web">
                                <span class="material-icons text-gray-400 group-hover:text-gray-900 mb-2">public</span>
                                <div class="font-medium text-gray-900">Generate from Web</div>
                                <div class="text-sm text-gray-500">Create a new quiz from any topic</div>
                            </button>
                        </div>
                    </div>

                    <!-- Quiz Options -->
                    <form class="space-y-6" id="quiz-form">
                        <div class="hidden space-y-4" id="web-quiz-options">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Topic</label>
                                <input
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent outline-none transition-all"
                                    id="quiz-topic-input" placeholder="e.g. Quantum Physics" type="text">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Number of Questions</label>
                                <input
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent outline-none transition-all"
                                    id="quiz-size" max="20" min="1" type="number" value="5" />
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Time Limit</label>
                                <select
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent outline-none transition-all"
                                    id="quiz-timer">
                                    <option value="0">Untimed</option>
                                    <option value="30">30 Seconds per question</option>
                                    <option value="60">1 Minute per question</option>
                                    <option value="120">2 Minutes per question</option>
                                </select>
                            </div>
                        </div>

                        <button
                            class="w-full bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2"
                            type="submit">
                            <span class="material-icons">play_arrow</span>
                            Start Quiz
                        </button>
                    </form>
                </div>

                <!-- Quiz Questions -->
                <div class="hidden mt-6 bg-white rounded-xl shadow-sm border border-gray-200 p-6 relative"
                    id="quiz-questions">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-xl font-semibold text-gray-900">Quiz</h2>
                        <div class="flex items-center gap-4">
                            <div class="hidden flex items-center gap-1 text-gray-600 font-mono bg-gray-100 px-3 py-1 rounded-md"
                                id="quiz-timer-display">
                                <span class="material-icons text-sm">timer</span>
                                <span class="time-left">00:00</span>
                            </div>
                            <div class="text-sm text-gray-600">
                                Question <span class="font-semibold" id="current-question">1</span> of <span
                                    class="font-semibold" id="total-questions">5</span>
                            </div>
                        </div>
                    </div>
                    <div class="quiz-content mb-6" id="quiz-content"></div>
                    <div class="flex gap-4">
                        <button
                            class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-6 rounded-lg border border-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                            disabled id="prev-question" type="button">
                            Previous
                        </button>
                        <button
                            class="flex-1 bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 px-6 rounded-lg transition-colors"
                            id="next-question" type="button">
                            Next
                        </button>
                        <button
                            class="hidden flex-1 bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 px-6 rounded-lg transition-colors"
                            id="submit-quiz" type="button">
                            Submit Quiz
                        </button>
                    </div>
                </div>

                <!-- Quiz Results -->
                <div class="hidden mt-6 bg-white rounded-xl shadow-sm border border-gray-200 p-6" id="quiz-results">
                    <!-- Content populated by JS -->
                </div>

                <!-- Quiz History -->
                <div class="mt-8" id="quiz-history-section">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Quiz History</h3>
                    <div class="space-y-4" id="quiz-history-list">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Quiz Completion Popup -->
    <div class="fixed inset-0 bg-gray-900 bg-opacity-75 z-50 hidden flex items-center justify-center backdrop-blur-sm"
        id="quiz-completion-popup">
        <div class="bg-white rounded-2xl p-8 max-w-lg w-full mx-4 shadow-2xl transform transition-all">
            <div class="text-center mb-8">
                <div
                    class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 text-green-600 mb-4">
                    <span class="material-icons text-3xl">emoji_events</span>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">Quiz Completed!</h3>
                <div class="text-4xl font-bold text-gray-900 my-4" id="popup-score">0/0</div>
                <p class="text-gray-600" id="popup-message">Great job!</p>
            </div>

            <div class="space-y-3">
                <button
                    class="w-full bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2"
                    id="btn-try-harder">
                    <span class="material-icons">psychology</span>
                    Try Harder Quiz (AI)
                </button>
                <button
                    class="w-full bg-white hover:bg-gray-50 text-gray-700 font-medium py-3 px-6 rounded-lg border border-gray-300 transition-colors flex items-center justify-center gap-2"
                    id="btn-revise-mistakes">
                    <span class="material-icons">school</span>
                    Revise Mistakes
                </button>
                <button
                    class="w-full bg-transparent hover:bg-gray-100 text-gray-500 font-medium py-3 px-6 rounded-lg transition-colors"
                    id="btn-close-popup">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="fixed inset-0 bg-gray-900 bg-opacity-75 z-50 hidden flex items-center justify-center backdrop-blur-sm"
        id="loading-overlay">
        <div class="bg-white rounded-2xl p-8 max-w-sm w-full mx-4 text-center shadow-2xl transform transition-all">
            <div class="loading-spinner mb-6 mx-auto"></div>
            <h3 class="text-xl font-bold text-gray-900 mb-2">Generating Flashcards</h3>
            <p class="text-gray-600">Please wait while our AI crafts your study material...</p>
        </div>
    </div>

    <template id="card-template">
        <article class="card absolute inset-0" tabindex="0">
            <div class="card-inner w-full h-full">
                <div
                    class="card-front w-full h-full bg-white rounded-xl shadow-lg border border-gray-200 p-8 flex flex-col">
                    <div class="card-content flex-1 flex items-center justify-center">
                        <p class="card-question text-xl text-gray-900 leading-relaxed text-center font-medium"></p>
                    </div>
                    <div class="card-actions mt-6">
                        <button
                            class="show-answer w-full bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2">
                            <span class="material-icons">visibility</span>
                            Show Answer
                        </button>
                    </div>
                </div>
                <div
                    class="card-back w-full h-full bg-white rounded-xl shadow-lg border border-gray-200 p-8 flex flex-col transform rotate-y-180 overflow-y-auto">
                    <div class="card-content flex-1">
                        <div class="mb-6 pb-6 border-b border-gray-100">
                            <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Question
                            </div>
                            <p class="card-question-back text-lg text-gray-900 font-medium leading-relaxed"></p>
                        </div>

                        <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Answer</div>
                        <p class="card-brief-answer text-lg text-gray-700 leading-relaxed mb-4"></p>

                        <div class="card-source hidden mt-6 pt-6 border-t border-gray-100">
                            <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">For more
                                details:
                            </div>
                            <div class="source-info text-sm text-gray-600 flex items-center gap-2">
                                <span class="material-icons text-base">description</span>
                                <span></span>
                            </div>
                        </div>
                    </div>
                    <div class="card-actions mt-6">
                        <button
                            class="w-full bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2">
                            <span class="material-icons">check</span>
                            I got it!
                        </button>
                    </div>
                </div>
            </div>
        </article>
    </template>

    <script src="dist/main.js" type="module"></script>
</body>

</html>